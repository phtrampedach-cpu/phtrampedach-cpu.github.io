<!doctype html>
<html lang="da">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gæt - Login</title>
  <link rel="stylesheet" href="styles.css">

  <!-- Firebase biblioteker -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
</head>
<body>

<header>
  <nav class="menu-bar">
    <a href="index.html">Forside</a>
    <a href="about.html">Om mig</a>
    <a href="gaet.html" class="active">Gæt</a>
    <a href="contact.html">Kontakt</a>
  </nav>
</header>

<main>
  <h1>Login eller opret bruger</h1>

  <div id="login-section">
    <input type="email" id="email" placeholder="Email">
    <input type="password" id="password" placeholder="Adgangskode">
    <button id="login-btn">Login / Opret bruger</button>
    <p id="login-msg"></p>
  </div>
</main>

<script>
  // ================================
  // Firebase setup
  // ================================
const firebaseConfig = {
  apiKey: "AIzaSyBQBoHOBENQHP20J7pv1kkEs2gTd7r_flg",
  authDomain: "trampestips.firebaseapp.com",
  projectId: "trampestips",
  storageBucket: "trampestips.firebasestorage.app",
  messagingSenderId: "759235788489",
  appId: "1:759235788489:web:9515bc438a7c7d68469718",
  measurementId: "G-B6YTNFRJPS"
};

  firebase.initializeApp(firebaseConfig);
 const auth = firebase.auth();        // til login
 const analytics = getAnalytics(app);
 const db = firebase.firestore();     // til gæt og point

  // ================================
  // Login / Opret bruger
  // ================================
  document.getElementById("login-btn").addEventListener("click", () => {
    const email = document.getElementById("email").value.trim();
    const password = document.getElementById("password").value;

    if (!email || !password) {
      document.getElementById("login-msg").textContent = "Udfyld både email og adgangskode.";
      return;
    }

    auth.signInWithEmailAndPassword(email, password)
      .then(() => {
        document.getElementById("login-msg").textContent = "Login succesfuldt!";
        setTimeout(() => { window.location.href = "dashboard.html"; }, 800);
      })
      .catch(error => {
        switch(error.code) {
          case "auth/user-not-found":
            // Opret ny bruger
            auth.createUserWithEmailAndPassword(email, password)
              .then(() => {
                document.getElementById("login-msg").textContent = "Bruger oprettet! Logger ind...";
                setTimeout(() => { window.location.href = "dashboard.html"; }, 800);
              })
              .catch(err => {
                // Håndter fejl ved oprettelse
                switch(err.code) {
                  case "auth/email-already-in-use":
                    document.getElementById("login-msg").textContent = "Denne email er allerede i brug!";
                    break;
                  case "auth/invalid-email":
                    document.getElementById("login-msg").textContent = "Ugyldig email!";
                    break;
                  case "auth/weak-password":
                    document.getElementById("login-msg").textContent = "Adgangskode skal være mindst 6 tegn!";
                    break;
                  default:
                    document.getElementById("login-msg").textContent = "Fejl ved oprettelse: " + err.message;
                }
              });
            break;

          case "auth/wrong-password":
            document.getElementById("login-msg").textContent = "Forkert adgangskode!";
            break;

          case "auth/invalid-email":
            document.getElementById("login-msg").textContent = "Ugyldig email!";
            break;

          case "auth/invalid-login-credentials":
            document.getElementById("login-msg").textContent = "Email eller adgangskode er forkert!";
            break;

          default:
            document.getElementById("login-msg").textContent = "Fejl: " + error.message;
        }
      });
  });

  // ================================
  // Hvis bruger allerede er logget ind → send direkte videre
  // ================================
  auth.onAuthStateChanged(user => {
    if (user) {
      window.location.href = "dashboard.html";
    }
  });
</script>

